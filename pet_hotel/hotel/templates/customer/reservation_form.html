{% extends "public_base.html" %}
{% load static %}


{% block extra_css %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css">
<link rel="stylesheet" href="{% static 'reservation/css/public_base.css' %}">
<link rel="stylesheet" href="{% static 'reservation/css/reservation_form.css' %}">
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>
<script src="{% static 'reservation/js/reservation_form.js' %}"></script>
{% endblock %}


{% block content %}
<div class="container mt-5">
    <h2>{{ customer.name }} ë‹˜ì˜ ì˜ˆì•½</h2>

    <form method="post" action="{% url 'customer:reservation_submit' customer.token %}" novalidate
          class="needs-validation" id="reservationForm">
        {% csrf_token %}
        <!-- ë°˜ë ¤ê²¬ ì„ íƒ -->
        <div class="mb-3 form-step visible" id="step-1">

            <p id="selectedDogCount" class="text-muted small mb-2">
                ğŸ¶ ì„ íƒëœ ë°˜ë ¤ê²¬: 0ë§ˆë¦¬
            </p>

            <div class="dog-selection">
                {% for dog in customer.dogs.all %}
                <label class="dog-option">
                    <input type="checkbox" name="dog_ids" value="{{ dog.id }}">
                    <div class="dog-card">
                        <div class="dog-header">
                            <strong>{{ dog.name }}</strong>
                            <span class="badge">{{ dog.breed }}</span>
                        </div>
                        <div class="dog-gender">
                            {% if dog.gender == "M" %}
                            â™‚ ìˆ˜ì»·
                            {% else %}
                            â™€ ì•”ì»·
                            {% endif %}
                        </div>
                        <div class="check-icon">âœ“</div>
                    </div>
                </label>
                {% endfor %}

                <label class="dog-option">
                    <a href="{% url 'customer:register_dog' token=customer.token %}" class="btn">ì• ê²¬ ì¶”ê°€</a>
                </label>
            </div>

        </div>
        <!-- STEP 2: ì„œë¹„ìŠ¤ ì„ íƒ -->
        <div id="step-2" class="form-step">
            <h4>2ë‹¨ê³„: ì„œë¹„ìŠ¤ ì„ íƒ</h4>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="services" value="hotel" id="serviceHotel">
                <label class="form-check-label" for="serviceHotel">ğŸ¨ í˜¸í…”ë§</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="services" value="daycare" id="serviceDaycare">
                <label class="form-check-label" for="serviceDaycare">ğŸ¾ ìœ ì¹˜ì›</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" name="services" value="playroom" id="servicePlayroom">
                <label class="form-check-label" for="servicePlayroom">ğŸ  ë†€ì´ë°©</label>
            </div>
        </div>
        <div class="form-step" id="step-3">
            <!-- ì…ì‹¤/í‡´ì‹¤ ë‚ ì§œ -->
            <div class="date-time-picker-container">
                <label for="date-range">ğŸ¾ ì…Â·í‡´ì‹¤ ë‚ ì§œ ì„ íƒ</label>
                <input type="text" id="date-range" placeholder="ì˜ˆì‹œ) 2025-03-01 ~ 2025-04-05 | ì…ì‹¤ê³¼ í‡´ì‹¤ì„ ì„ íƒí•´ì£¼ì„¸ìš”">
                <input type="hidden" name="check_in_date" id="check-in-date">
                <input type="hidden" name="check_out_date" id="check-out-date">

                <label for="check-in-time">ğŸ•’ ì…ì‹¤ ì˜ˆì • ì‹œê°„</label>
                <input type="text" id="check-in-time" name="check_in_time" placeholder="ex) 10:00">

                <label for="check-out-time">ğŸ•’ í‡´ì‹¤ ì˜ˆì • ì‹œê°„</label>
                <input type="text" id="check-out-time" name="check_out_time" placeholder="ex) 12:00">
            </div>
        </div>
        <!-- ìš”ì²­ì‚¬í•­ -->
        <div class="mb-4 form-step" id="step-4">
            <label for="notes" class="form-label">ì¶”ê°€ ìš”ì²­ì‚¬í•­</label>
            <textarea
                    class="form-control"
                    id="notes"
                    name="notes"
                    rows="3"
                    placeholder="ì˜ˆ) ê°œì¸ë£¸ ë“± | ì—†ìœ¼ë©´ ê³µë€ ê°€ëŠ¥"
            ></textarea>
            <button type="submit" class="btn btn-primary btn-lg">
                ì œì¶œ í•˜ê¸°
            </button>
        </div>
    </form>
</div>

{% endblock %}